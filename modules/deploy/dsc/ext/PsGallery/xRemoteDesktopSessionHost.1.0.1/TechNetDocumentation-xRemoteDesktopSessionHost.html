<p><span style="font-size: 13.5pt;" lang="EN-IN">The<strong> xRemoteDesktopSessionHost</strong> module is a part of the Windows PowerShell Desired State Configuration (DSC) Resource Kit, which is a collection of DSC Resources produced by the PowerShell Team.  This module contains the <strong>xRDSessionDeployment, xRDSessionCollection, xRDSessionCollectionConfiguration, and xRDRemoteApp</strong><span><strong>&nbsp;</strong></span> resources, and allows creation and configuration of a Remote Desktop Session Host  (RDSH) instance.&nbsp; </span></p>
<div class="WordSection1">
<p class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">All of the resources in the DSC Resource Kit are provided AS IS, and are not supported through any Microsoft standard support program or service. The "x" in  xDatabase stands for experimental</span></strong><span style="font-size: 13.5pt;" lang="EN-IN">, which means that these resources will be <strong>fix forward</strong> and monitored by the module owner(s).</span></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">Please leave comments, feature requests, and bug reports in the Q &amp; A tab for this module.</span></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">If you would like to modify <span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRemoteDesktopSessionHost</strong> </span>module, feel free. When modifying, please update the module name, resource friendly name, and MOF class name (instructions below). As specified in the license, you may copy or modify this resource as long as they are used on the Windows Platform.</span></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">For more information about Windows PowerShell Desired State Configuration, check out the blog posts on the <a href="http://blogs.msdn.com/b/powershell/">PowerShell Blog</a> (<a href="http://blogs.msdn.com/b/powershell/archive/2013/11/01/configuration-in-a-devops-world-windows-powershell-desired-state-configuration.aspx">this</a> is a good starting point). There  are also great community resources, such as <a href="http://powershell.org/wp/tag/dsc/"> PowerShell.org</a>, or <a href="http://www.powershellmagazine.com/tag/dsc/">PowerShell Magazine</a>. For more information on the DSC Resource Kit, check out <a href="http://go.microsoft.com/fwlink/?LinkID=389546">this blog post</a>.</span></p>
<p class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 18.0pt; font-family: &quot;Calibri Light&quot;,&quot;sans-serif&quot;; color: #2e74b5;" lang="EN-IN">Installation</span></strong></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">To install </span><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRemoteDesktopSessionHost</strong> </span><span style="font-size: 13.5pt;" lang="EN-IN">&nbsp;</span><span style="font-size: 13.5pt;" lang="EN-IN">module </span></p>
<ul type="disc">
<li class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">Unzip the content under $env:ProgramFiles\WindowsPowerShell\Modules folder</span> </li>
</ul>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">To confirm installation:</span></p>
<ul type="disc">
<li class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">Run <strong>Get-DSCResource</strong> to see that&nbsp;</span><span style="font-size: 13.5pt;" lang="EN-IN"><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment, xRDSessionCollection, xRDSessionCollectionConfiguration, and xRDRemoteApp</strong></span> </strong>are</span><span style="font-size: 13.5pt;" lang="EN-IN"> among the DSC Resources listed</span> </li>
</ul>
<p class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 18.0pt; font-family: &quot;Calibri Light&quot;,&quot;sans-serif&quot;; color: #2e74b5;" lang="EN-IN">Requirements</span></strong></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">This module requires the latest version of PowerShell (v4.0, which ships in Windows 8.1 or Windows Server 2012 R2). To easily use PowerShell 4.0 on older operating  systems, <a href="http://www.microsoft.com/en-us/download/details.aspx?id=40855"> install WMF 4.0</a>. Please read the installation instructions that are present on both the download page and the release notes for WMF 4.0.</span></p>
<p class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 18.0pt; font-family: &quot;Calibri Light&quot;,&quot;sans-serif&quot;; color: #2e74b5;" lang="EN-IN">Description</span></strong></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">This&nbsp;<span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRemoteDesktopSessionHost</strong></span> module contains the <span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment, xRDSessionCollection, xRDSessionCollectionConfiguration, and xRDRemoteApp</strong></span></strong></span> resources. <span style="font-size: 13.5pt;" lang="EN-IN"><span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment </strong></span></strong><span style="font-size: 13.5pt;" lang="EN-IN">creates and configures a deployment in RDSH</span></span></span>.&nbsp; <span style="font-size: 13.5pt;" lang="EN-IN"><span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionCollection </strong></span></strong><span style="font-size: 13.5pt;" lang="EN-IN">creates a RDSH collection.</span></span></span> <span style="font-size: 13.5pt;" lang="EN-IN"><span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionCollectionConfiguration </strong></span></strong><span style="font-size: 13.5pt;" lang="EN-IN">allows configuration of a RDSH collection.</span><span style="font-size: 13.5pt;" lang="EN-IN">&nbsp;</span></span></span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDRemoteApp</strong></span></strong></span></span> </strong>is used to publish applications for your RDSH collection. <br /> </span></p>
<p class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 18.0pt; font-family: &quot;Calibri Light&quot;,&quot;sans-serif&quot;; color: #2e74b5;" lang="EN-IN">Details</span></strong></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span><span style="font-size: 13.5pt;" lang="EN-IN">The </span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment</strong></span></strong></span></span><span style="font-size: 13.5pt;" lang="EN-IN"> resource has the following properties:</span></p>
<ul type="disc">
<li class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">SessionHost</span></strong><span style="font-size: 13.5pt;" lang="EN-IN">: Specifies the FQDN of a servers to host the RD Session Host role service.</span> </li>
<li class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">ConnectionBroker: </span></strong><span style="font-size: 13.5pt;" lang="EN-IN">The FQDN of a server to host the RD Connection Broker role service.</span> </li>
<li class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">WebAccessServer: </span></strong><span style="font-size: 13.5pt;" lang="EN-IN">The FQDN of a server to host the RD Web Access role service.</span> </li>
</ul>
<span style="font-size: 13.5pt;" lang="EN-IN">The</span><strong><span style="font-size: 13.5pt;" lang="EN-IN"> <span style="font-size: 13.5pt;" lang="EN-IN"><span><strong><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionCollection</strong></span></strong></span></span></span></strong><span style="font-size: 13.5pt;" lang="EN-IN"> resource has the following  properties:</span><br /> 
<ul type="disc">
<li class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">CollectionName:</span></strong><span style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;;" lang="EN-IN"> </span><span style="font-size: 13.5pt;" lang="EN-IN">Specifies a name for the session collection</span> </li>
<li class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">SessionHost</span></strong><span style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;;">:</span><span style="font-size: 13.5pt;" lang="EN-IN"> Specifies  a RD Session Host server to include in the session collection.</span> </li>
<li class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">CollectionDescription: </span></strong><span style="font-size: 13.5pt;" lang="EN-IN">A description for the collection.</span> </li>
</ul>
<ul type="disc">
<li class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 13.5pt;" lang="EN-IN">ConnectionBroker: </span></strong><span style="font-size: 13.5pt;" lang="EN-IN">The Remote Desktop Connection Broker (RD Connection Broker) server for a Remote Desktop deployment.</span> </li>
</ul>
<span style="font-size: 13.5pt;" lang="EN-IN">The<strong> <strong><strong>xRDSessionCollectionConfiguration</strong></strong></strong> resource has the following properties:<br /> 
<ul>
<li><strong>CollectionName:</strong> Specifies the name for the session collection </li>
<li><strong>ActiveSessionLimitMin:</strong>&nbsp; Specifies the maximum time, in minutes, an active session runs. After this period, the RD Session Host server ends the session. </li>
<li><strong>AuthenticateUsingNLA: </strong>Indicates whether to use Network Level Authentication (NLA). If this value is $True, Remote Desktop uses NLA to authenticate a user before the user sees a logon screen. </li>
<li><strong>AutomaticReconnectionEnabled: </strong>Indicates whether the Remote Desktop client attempts to reconnect after a connection interruption. </li>
<li><strong>BrokenConnectionAction: </strong>Specifies an action for an RD Session Host server to take after a connection interruption. </li>
<li><strong>ClientDeviceRedirectionOptions: </strong>Specifies a type of client device to be redirected to an RD Session Host server in this session collection. </li>
<li><strong>ClientPrinterAsDefault: </strong>Indicates whether to use the client printer or server printer as the default printer. If this value is $True, use the client printer as default. If this value is $False, use the server as default. </li>
<li><strong>ClientPrinterRedirected:</strong> Indicates whether to use client printer redirection, which routes print jobs from the Remote Desktop session to a printer attached to the client computer. </li>
<li><strong>CollectionDescription: </strong>Specifies a description of the session collection. </li>
<li><strong>ConnectionBroker: </strong>Specifies the Remote Desktop Connection Broker (RD Connection Broker) server for a Remote Desktop deployment. </li>
<li><strong>CustomRdpProperty: </strong>Specifies Remote Desktop Protocol (RDP) settings to include in the .rdp files for all Windows Server 2012 RemoteApp programs and remote desktops published in this collection. </li>
<li><strong>DisconnectedSessionLimitMin: </strong>Specifies a length of time, in minutes. After client disconnection from a session for this period, the RD Session Host ends the session. </li>
<li><strong>EncryptionLevel: </strong>Specifies the level of data encryption used for a Remote Desktop session. </li>
<li><strong>IdleSessionLimitMin: </strong>Specifies the length of time, in minutes, to wait before an RD Session Host logs off or disconnects an idle session. The BrokenConnectionAction parameter determines whether to log off or disconnect. </li>
<li><strong>MaxRedirectedMonitors: </strong>Specifies the maximum number of client monitors that an RD Session Host server can redirect to a remote session. The highest value for this parameter is 16. </li>
<li><strong>RDEasyPrintDriverEnabled: </strong>Specifies whether to enable the Remote Desktop Easy Print driver. </li>
<li><strong>SecurityLayer: </strong>Specifies which security protocol to use. </li>
<li><strong>TemporaryFoldersDeletedOnExit: </strong>Whether to delete temporary folders from the RD Session Host server for a disconnected session. </li>
<li><strong>UserGroup: </strong>Specifies a domain group authorized to connect to the RD Session Host servers in a session collection. </li>
</ul>
The<strong> <strong><strong>xRDRemoteApp</strong></strong></strong> resource has the following properties:<br /> 
<ul>
<li><strong>Alias:</strong> Specifies an alias for the RemoteApp program. </li>
<li><strong>CollectionName:</strong> Specifies the name of the personal virtual desktop collection or session collection. The cmdlet publishes the RemoteApp program to this collection. </li>
<li><strong>DisplayName: </strong>Specifies a name to display to users for the RemoteApp program. </li>
</ul>
<ul>
<li><strong>FilePath: </strong>Specifies a path for the executable file for the application. Do not include any environment variables. </li>
<li><strong>FileVirtualPath: </strong>Specifies a path for the application executable file. This path resolves to the same location as the value of the FilePath parameter, but it can include environment variables. </li>
<li><strong>FolderName: </strong>Specifies the name of the folder that the RemoteApp program appears in on the Remote Desktop Web Access (RD Web Access) webpage and in the Start menu for subscribed RemoteApp and Desktop Connections. </li>
<li><strong>CommandLineSetting: </strong>Specifies whether the RemoteApp program accepts command-line arguments from the client at connection time. </li>
<li><strong>RequiredCommandLine: </strong>Specifies a string that contains command-line arguments that the client can use at connection time with the RemoteApp program. </li>
<li><strong>IconIndex: </strong>Specifies the index within the icon file (specified by the IconPath parameter) where the RemoteApp program&rsquo;s icon can be found. </li>
<li><strong>IconPath: </strong>Specifies the path to a file containing the icon to display for the RemoteApp program identified by the Alias parameter. </li>
<li><strong>UserGroups: </strong>Specifies a domain group that can view the RemoteApp in RD Web Access, and in RemoteApp and Desktop Connections. To allow all users to see a RemoteApp program, provide a value of Null. </li>
<li><strong>ShowInWebAccess: </strong>Specifies whether to show the RemoteApp program in the RD Web Access server, and in RemoteApp and Desktop Connections that the user subscribes to. </li>
</ul>
<ul>
</ul>
</span>
<p class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 18.0pt; font-family: &quot;Calibri Light&quot;,&quot;sans-serif&quot;; color: #2e74b5;" lang="EN-IN">Renaming Requirements</span></strong></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">When making changes to these resources, we suggest the following practice:</span></p>
<p class="MsoNormal" style="margin-left: .5in; text-indent: -.25in; line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span>1.<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp; </span></span></span><span style="font-size: 13.5pt;" lang="EN-IN">Update the following names by prefixing your company/community name and replacing the <strong>"x"</strong> with <strong>"c"</strong> (short for "Community") or another prefix of your choice: </span></p>
<p class="MsoNormal" style="margin-left: 1.0in; text-indent: -.25in; line-height: normal;"><span style="font-size: 10.0pt; font-family: &quot;Courier New&quot;;" lang="EN-IN"><span>o<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp; </span></span></span><strong><span style="font-size: 13.5pt;" lang="EN-IN">Module name (ex: <span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment</strong></span></span></strong><span style="font-size: 13.5pt;" lang="EN-IN"> becomes <strong>c<span style="font-size: 13.5pt;" lang="EN-IN"><strong>RDSessionDeployment</strong></span></strong>) </span></p>
<p class="MsoNormal" style="margin-left: 1.0in; text-indent: -.25in; line-height: normal;"><span style="font-size: 10.0pt; font-family: &quot;Courier New&quot;;" lang="EN-IN"><span>o<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp; </span></span></span><strong><span style="font-size: 13.5pt;" lang="EN-IN">Resource folder (ex: MSFT_<strong><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment</strong></span></span></strong></span></strong><span style="font-size: 13.5pt;" lang="EN-IN"> becomes <strong>Contoso_c<strong><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>RDSessionDeployment</strong></span></span></strong></strong>) </span></p>
<p class="MsoNormal" style="margin-left: 1.0in; text-indent: -.25in; line-height: normal;"><span style="font-size: 10.0pt; font-family: &quot;Courier New&quot;;" lang="EN-IN"><span>o<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp; </span></span></span><strong><span style="font-size: 13.5pt;" lang="EN-IN">Resource Name (ex: MSFT_<strong><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment</strong></span></span></strong> </span></strong><span style="font-size: 13.5pt;" lang="EN-IN">becomes <strong>Contoso_c<strong><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>RDSessionDeployment</strong></span></span></strong></strong>) </span></p>
<p class="MsoNormal" style="margin-left: .5in; text-indent: -.25in; line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span>2.<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 13.5pt;" lang="EN-IN">Update module and metadata information in the module manifest </span></p>
<p class="MsoNormal" style="margin-left: .5in; text-indent: -.25in; line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span>3.<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 13.5pt;" lang="EN-IN">Update any configuration that use these resources </span></p>
<p class="MsoNormal" style="line-height: normal;"><em><span style="font-size: 13.5pt;" lang="EN-IN">We reserve resource and module names without prefixes ("x" or "c") for future use (e.g. "xRDSessionDeployment"). If the next version of Windows Server ships with  a "RDSessionDeployment" resource, we don't want to break any configurations that use any community modifications. Please keep a prefix such as "c" on all community modifications.</span></em></p>
<p class="MsoNormal" style="line-height: normal;"><strong><span style="font-size: 18.0pt; font-family: &quot;Calibri Light&quot;,&quot;sans-serif&quot;; color: #2e74b5;" lang="EN-IN">Versions</span></strong></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">1.0.0.0</span></p>
<ul type="disc">
<li class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN">Initial release with the following resources </span> 
<ul type="circle">
<li class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionDeployment</strong></span></span> </li>
<li class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionCollection</strong></span></span> </li>
<li class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDSessionCollectionConfiguration</strong></span></span> </li>
<li class="MsoNormal" style="line-height: normal;"><span style="font-size: 13.5pt;" lang="EN-IN"><span style="font-size: 13.5pt;" lang="EN-IN"><strong>xRDRemoteApp</strong><span><strong> <br /> </strong></span></span></span></li>
</ul>
</li>
</ul>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><strong><span style="font-size: 18.0pt; font-family: &quot;Calibri Light&quot;,&quot;sans-serif&quot;; color: #2e74b5;" lang="EN-IN">Example: End to End<br /> </span></strong></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">param (
[string]$brokerFQDN,
[string]$webFQDN,
[string]$collectionName,
[string]$collectionDescription
)

$localhost = [System.Net.Dns]::GetHostByName((hostname)).HostName

if (!$collectionName) {$collectionName = "Tenant Jump Box"}
if (!$collectionDescription) {$collectionDescription = "Remote Desktop instance for accessing an isolated network environment."}

Configuration RemoteDesktopSessionHost
{
    param
    (
        
        # Connection Broker Name
        [Parameter(Mandatory)]
        [String]$collectionName,

        # Connection Broker Description
        [Parameter(Mandatory)]
        [String]$collectionDescription,

        # Connection Broker Node Name
        [String]$connectionBroker,

        # Web Access Node Name
        [String]$webAccessServer
    )
    Import-DscResource -Module xRemoteDesktopSessionHost
    if (!$connectionBroker) {$connectionBroker = $localhost}
    if (!$connectionWebAccessServer) {$webAccessServer = $localhost}

    Node "localhost"
    {

        LocalConfigurationManager
        {
            RebootNodeIfNeeded = $true
        }

        WindowsFeature Remote-Desktop-Services
        {
            Ensure = "Present"
            Name = "Remote-Desktop-Services"
        }

        WindowsFeature RDS-RD-Server
        {
            Ensure = "Present"
            Name = "RDS-RD-Server"
        }

        WindowsFeature Desktop-Experience
        {
            Ensure = "Present"
            Name = "Desktop-Experience"
        }

        WindowsFeature RSAT-RDS-Tools
        {
            Ensure = "Present"
            Name = "RSAT-RDS-Tools"
            IncludeAllSubFeature = $true
        }

        if ($localhost -eq $connectionBroker) {
            WindowsFeature RDS-Connection-Broker
            {
                Ensure = "Present"
                Name = "RDS-Connection-Broker"
            }
        }

        if ($localhost -eq $webAccessServer) {
            WindowsFeature RDS-Web-Access
            {
                Ensure = "Present"
                Name = "RDS-Web-Access"
            }
        }

        WindowsFeature RDS-Licensing
        {
            Ensure = "Present"
            Name = "RDS-Licensing"
        }
  
        xRDSessionDeployment Deployment
        {
            SessionHost = $localhost
            ConnectionBroker = if ($ConnectionBroker) {$ConnectionBroker} else {$localhost}
            WebAccessServer = if ($WebAccessServer) {$WebAccessServer} else {$localhost}
            DependsOn = "[WindowsFeature]Remote-Desktop-Services", "[WindowsFeature]RDS-RD-Server"
        }

        xRDSessionCollection Collection
        {
            CollectionName = $collectionName
            CollectionDescription = $collectionDescription
            SessionHost = $localhost
            ConnectionBroker = if ($ConnectionBroker) {$ConnectionBroker} else {$localhost}
            DependsOn = "[xRDSessionDeployment]Deployment"
        }
        xRDSessionCollectionConfiguration CollectionConfiguration
        {
        CollectionName = $collectionName
        CollectionDescription = $collectionDescription
        ConnectionBroker = if ($ConnectionBroker) {$ConnectionBroker} else {$localhost}        
        TemporaryFoldersDeletedOnExit = $false
        SecurityLayer = "SSL"
        DependsOn = "[xRDSessionCollection]Collection"
        }
        xRDRemoteApp Calc
        {
        CollectionName = $collectionName
        DisplayName = "Calculator"
        FilePath = "C:\Windows\System32\calc.exe"
        Alias = "calc"
        DependsOn = "[xRDSessionCollection]Collection"
        }
        xRDRemoteApp Mstsc
        {
        CollectionName = $collectionName
        DisplayName = "Remote Desktop"
        FilePath = "C:\Windows\System32\mstsc.exe"
        Alias = "mstsc"
        DependsOn = "[xRDSessionCollection]Collection"
        }
    }
}

write-verbose "Creating configuration with parameter values:"
write-verbose "Collection Name: $collectionName"
write-verbose "Collection Description: $collectionDescription"
write-verbose "Connection Broker: $brokerFQDN"
write-verbose "Web Access Server: $webFQDN"

RemoteDesktopSessionHost -collectionName $collectionName -collectionDescription $collectionDescription -connectionBroker $brokerFQDN -webAccessServer $webFQDN -OutputPath .\RDSDSC\

Set-DscLocalConfigurationManager -verbose -path .\RDSDSC\

Start-DscConfiguration -wait -force -verbose -path .\RDSDSC\</pre>
<div class="preview">
<pre class="powershell"><span class="powerShell__keyword">param</span>&nbsp;(&nbsp;
[string]<span class="powerShell__variable">$brokerFQDN</span>,&nbsp;
[string]<span class="powerShell__variable">$webFQDN</span>,&nbsp;
[string]<span class="powerShell__variable">$collectionName</span>,&nbsp;
[string]<span class="powerShell__variable">$collectionDescription</span>&nbsp;
)&nbsp;
&nbsp;
<span class="powerShell__variable">$localhost</span>&nbsp;=&nbsp;[System.Net.Dns]::GetHostByName((hostname)).HostName&nbsp;
&nbsp;
<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__operator">!</span><span class="powerShell__variable">$collectionName</span>)&nbsp;{<span class="powerShell__variable">$collectionName</span>&nbsp;=&nbsp;<span class="powerShell__string">"Tenant&nbsp;Jump&nbsp;Box"</span>}&nbsp;
<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__operator">!</span><span class="powerShell__variable">$collectionDescription</span>)&nbsp;{<span class="powerShell__variable">$collectionDescription</span>&nbsp;=&nbsp;<span class="powerShell__string">"Remote&nbsp;Desktop&nbsp;instance&nbsp;for&nbsp;accessing&nbsp;an&nbsp;isolated&nbsp;network&nbsp;environment."</span>}&nbsp;
&nbsp;
Configuration&nbsp;RemoteDesktopSessionHost&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">param</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Connection&nbsp;Broker&nbsp;Name</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Parameter(Mandatory)]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[String]<span class="powerShell__variable">$collectionName</span>,&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Connection&nbsp;Broker&nbsp;Description</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Parameter(Mandatory)]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[String]<span class="powerShell__variable">$collectionDescription</span>,&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Connection&nbsp;Broker&nbsp;Node&nbsp;Name</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[String]<span class="powerShell__variable">$connectionBroker</span>,&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Web&nbsp;Access&nbsp;Node&nbsp;Name</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[String]<span class="powerShell__variable">$webAccessServer</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Import<span class="powerShell__operator">-</span>DscResource&nbsp;<span class="powerShell__operator">-</span>Module&nbsp;xRemoteDesktopSessionHost&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__operator">!</span><span class="powerShell__variable">$connectionBroker</span>)&nbsp;{<span class="powerShell__variable">$connectionBroker</span>&nbsp;=&nbsp;<span class="powerShell__variable">$localhost</span>}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__operator">!</span><span class="powerShell__variable">$connectionWebAccessServer</span>)&nbsp;{<span class="powerShell__variable">$webAccessServer</span>&nbsp;=&nbsp;<span class="powerShell__variable">$localhost</span>}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Node&nbsp;<span class="powerShell__string">"localhost"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalConfigurationManager&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RebootNodeIfNeeded&nbsp;=&nbsp;<span class="powerShell__variable">$true</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsFeature&nbsp;Remote<span class="powerShell__operator">-</span>Desktop<span class="powerShell__operator">-</span>Services&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">"Present"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;<span class="powerShell__string">"Remote-Desktop-Services"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsFeature&nbsp;RDS<span class="powerShell__operator">-</span><span class="powerShell__alias">RD</span><span class="powerShell__operator">-</span>Server&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">"Present"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;<span class="powerShell__string">"RDS-RD-Server"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsFeature&nbsp;Desktop<span class="powerShell__operator">-</span>Experience&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">"Present"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;<span class="powerShell__string">"Desktop-Experience"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsFeature&nbsp;RSAT<span class="powerShell__operator">-</span>RDS<span class="powerShell__operator">-</span>Tools&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">"Present"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;<span class="powerShell__string">"RSAT-RDS-Tools"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IncludeAllSubFeature&nbsp;=&nbsp;<span class="powerShell__variable">$true</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$localhost</span>&nbsp;<span class="powerShell__operator">-</span>eq&nbsp;<span class="powerShell__variable">$connectionBroker</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsFeature&nbsp;RDS<span class="powerShell__operator">-</span>Connection<span class="powerShell__operator">-</span>Broker&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">"Present"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;<span class="powerShell__string">"RDS-Connection-Broker"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$localhost</span>&nbsp;<span class="powerShell__operator">-</span>eq&nbsp;<span class="powerShell__variable">$webAccessServer</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsFeature&nbsp;RDS<span class="powerShell__operator">-</span>Web<span class="powerShell__operator">-</span>Access&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">"Present"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;<span class="powerShell__string">"RDS-Web-Access"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WindowsFeature&nbsp;RDS<span class="powerShell__operator">-</span>Licensing&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">"Present"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;<span class="powerShell__string">"RDS-Licensing"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xRDSessionDeployment&nbsp;Deployment&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionHost&nbsp;=&nbsp;<span class="powerShell__variable">$localhost</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConnectionBroker&nbsp;=&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$ConnectionBroker</span>)&nbsp;{<span class="powerShell__variable">$ConnectionBroker</span>}&nbsp;<span class="powerShell__keyword">else</span>&nbsp;{<span class="powerShell__variable">$localhost</span>}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WebAccessServer&nbsp;=&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$WebAccessServer</span>)&nbsp;{<span class="powerShell__variable">$WebAccessServer</span>}&nbsp;<span class="powerShell__keyword">else</span>&nbsp;{<span class="powerShell__variable">$localhost</span>}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DependsOn&nbsp;=&nbsp;<span class="powerShell__string">"[WindowsFeature]Remote-Desktop-Services"</span>,&nbsp;<span class="powerShell__string">"[WindowsFeature]RDS-RD-Server"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xRDSessionCollection&nbsp;Collection&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CollectionName&nbsp;=&nbsp;<span class="powerShell__variable">$collectionName</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CollectionDescription&nbsp;=&nbsp;<span class="powerShell__variable">$collectionDescription</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionHost&nbsp;=&nbsp;<span class="powerShell__variable">$localhost</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConnectionBroker&nbsp;=&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$ConnectionBroker</span>)&nbsp;{<span class="powerShell__variable">$ConnectionBroker</span>}&nbsp;<span class="powerShell__keyword">else</span>&nbsp;{<span class="powerShell__variable">$localhost</span>}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DependsOn&nbsp;=&nbsp;<span class="powerShell__string">"[xRDSessionDeployment]Deployment"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xRDSessionCollectionConfiguration&nbsp;CollectionConfiguration&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CollectionName&nbsp;=&nbsp;<span class="powerShell__variable">$collectionName</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CollectionDescription&nbsp;=&nbsp;<span class="powerShell__variable">$collectionDescription</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConnectionBroker&nbsp;=&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$ConnectionBroker</span>)&nbsp;{<span class="powerShell__variable">$ConnectionBroker</span>}&nbsp;<span class="powerShell__keyword">else</span>&nbsp;{<span class="powerShell__variable">$localhost</span>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TemporaryFoldersDeletedOnExit&nbsp;=&nbsp;<span class="powerShell__variable">$false</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecurityLayer&nbsp;=&nbsp;<span class="powerShell__string">"SSL"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DependsOn&nbsp;=&nbsp;<span class="powerShell__string">"[xRDSessionCollection]Collection"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xRDRemoteApp&nbsp;Calc&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CollectionName&nbsp;=&nbsp;<span class="powerShell__variable">$collectionName</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DisplayName&nbsp;=&nbsp;<span class="powerShell__string">"Calculator"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FilePath&nbsp;=&nbsp;<span class="powerShell__string">"C:\Windows\System32\calc.exe"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alias&nbsp;=&nbsp;<span class="powerShell__string">"calc"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DependsOn&nbsp;=&nbsp;<span class="powerShell__string">"[xRDSessionCollection]Collection"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xRDRemoteApp&nbsp;Mstsc&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CollectionName&nbsp;=&nbsp;<span class="powerShell__variable">$collectionName</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DisplayName&nbsp;=&nbsp;<span class="powerShell__string">"Remote&nbsp;Desktop"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FilePath&nbsp;=&nbsp;<span class="powerShell__string">"C:\Windows\System32\mstsc.exe"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alias&nbsp;=&nbsp;<span class="powerShell__string">"mstsc"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DependsOn&nbsp;=&nbsp;<span class="powerShell__string">"[xRDSessionCollection]Collection"</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}&nbsp;
&nbsp;
<span class="powerShell__cmdlets">write-verbose</span>&nbsp;<span class="powerShell__string">"Creating&nbsp;configuration&nbsp;with&nbsp;parameter&nbsp;values:"</span>&nbsp;
<span class="powerShell__cmdlets">write-verbose</span>&nbsp;<span class="powerShell__string">"Collection&nbsp;Name:&nbsp;$collectionName"</span>&nbsp;
<span class="powerShell__cmdlets">write-verbose</span>&nbsp;<span class="powerShell__string">"Collection&nbsp;Description:&nbsp;$collectionDescription"</span>&nbsp;
<span class="powerShell__cmdlets">write-verbose</span>&nbsp;<span class="powerShell__string">"Connection&nbsp;Broker:&nbsp;$brokerFQDN"</span>&nbsp;
<span class="powerShell__cmdlets">write-verbose</span>&nbsp;<span class="powerShell__string">"Web&nbsp;Access&nbsp;Server:&nbsp;$webFQDN"</span>&nbsp;
&nbsp;
RemoteDesktopSessionHost&nbsp;<span class="powerShell__operator">-</span>collectionName&nbsp;<span class="powerShell__variable">$collectionName</span>&nbsp;<span class="powerShell__operator">-</span>collectionDescription&nbsp;<span class="powerShell__variable">$collectionDescription</span>&nbsp;<span class="powerShell__operator">-</span>connectionBroker&nbsp;<span class="powerShell__variable">$brokerFQDN</span>&nbsp;<span class="powerShell__operator">-</span>webAccessServer&nbsp;<span class="powerShell__variable">$webFQDN</span>&nbsp;<span class="powerShell__operator">-</span>OutputPath&nbsp;.\RDSDSC\&nbsp;
&nbsp;
Set<span class="powerShell__operator">-</span>DscLocalConfigurationManager&nbsp;<span class="powerShell__operator">-</span>verbose&nbsp;<span class="powerShell__operator">-</span>path&nbsp;.\RDSDSC\&nbsp;
&nbsp;
Start<span class="powerShell__operator">-</span>DscConfiguration&nbsp;<span class="powerShell__operator">-</span>wait&nbsp;<span class="powerShell__operator">-</span>force&nbsp;<span class="powerShell__operator">-</span>verbose&nbsp;<span class="powerShell__operator">-</span>path&nbsp;.\RDSDSC\</pre>
</div>
</div>
</div>
</div>