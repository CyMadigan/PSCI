<html>
<body>

            <div id="longDesc">
                <span style="font-family:Calibri; font-size:medium">
                    <h1 style="font-family:Calibri Light; color:#2e74b5; font-size:large">Introduction</h1>
                    <p>
                        The<strong> xWordPress</strong> module is a part of the Windows PowerShell Desired State Configuration (DSC) Resource Kit, which is a collection of DSC Resources produced by the PowerShell Team. This module contains the
                        <strong>xWordPressSite and xIisWordPressSite</strong> resources. This DSC Resource allows you to setup a WordPress Site.
                    </p>
                    <p>
                        <strong>All of the resources in the DSC Resource Kit are provided AS IS, and are not supported through any Microsoft standard support program or service. The &quot;&quot;x&quot; in xWordPress stands for experimental</strong>, which means that these resources will be
                        <strong>fix forward</strong> and monitored by the module owner(s).
                    </p>
                    <p>Please leave comments, feature requests, and bug reports in the Q &amp; A tab for this module.</p>
                    <p>
                        If you would like to modify <strong>xWordPress</strong> module, feel free. When modifying, please update the module name, resource friendly name, and MOF class name (instructions below). As specified in the license, you may copy or modify this resource as
                        long as they are used on the Windows Platform.
                    </p>
                    <p>
                        For more information about Windows PowerShell Desired State Configuration, check out the blog posts on the
                        <a href="http://blogs.msdn.com/b/powershell/"><span style="color:#0000ff">PowerShell Blog</span></a> (<a href="http://blogs.msdn.com/b/powershell/archive/2013/11/01/configuration-in-a-devops-world-windows-powershell-desired-state-configuration.aspx"><span style="color:#0000ff">this</span></a>
                        is a good starting point). There are also great community resources, such as <a href="http://powershell.org/wp/tag/dsc/">
                            <span style="color:#0000ff">PowerShell.org</span>
                        </a>, or <a href="http://www.powershellmagazine.com/tag/dsc/">
                            <span style="color:#0000ff">PowerShell Magazine</span>
                        </a>. For more information on the DSC Resource Kit, check out
                        <a href="http://go.microsoft.com/fwlink/?LinkID=389546"><span style="color:#0000ff">this blog post</span></a>.
                    </p>
                </span>
                <h1 style="color:#2e74b5; font-family:Calibri Light; font-size:large">Installation</h1>
                <p>To install <strong>xWordPress</strong> module</p>
                <ul style="list-style-type:disc; direction:ltr">
                    <li>Unzip the content under $env:ProgramFiles\WindowsPowerShell\Modules folder </li>
                </ul>
                <p>To confirm installation:</p>
                <ul style="list-style-type:disc; direction:ltr">
                    <li>
                        Run <strong>Get-DSCResource</strong> to see that <strong>xWordPressSite</strong> is among the DSC Resources listed
                    </li>
                </ul>
                <h1 style="color:#2e74b5; font-family:Calibri Light; font-size:large">Requirements</h1>
                <p>
                    This module requires the Windows Management Framework (WMF) 5.0 Experimental Release July 2014, which contains functionality that has been updated from WMF 4.0. TheWMF 5.0 Experimental Release July 2014 is available for installation on Windows 8.1 and Windows
                    Server 2012 R2. More information about the content of the WMF 5.0 Experimental Release July 2014 is available in its dedicated release notes, included in the download links below.<br>
                    <br>
                    <strong>Notice: </strong>WMF 5.0 Experimental Release July 2014 is delivered as an MSU installation package via the links below. Installing this will update the PowerShell, WMI, and WinRM components of your Windows installation. change the state of your machine,
                    as opposed to the scripts in Resource Kit. If you choose &ldquo;Open&rdquo; from either the x64 or x86 direct download links, the package will be downloaded, and the install will update your system with these new components.<br>
                    <br>
                    <strong>Disclaimer:</strong> There is some scenarios in WMF 5.0 Experimental July 2014 with incomplete or missing functionality. This is also included in the dedicated release notes, which are included in the download links below.
                    <br>
                    <br>
                    Direct Download Links:
                </p>
                <ul style="list-style-type:disc; direction:ltr">
                    <li>
                        <a href="http://download.microsoft.com/download/E/D/B/EDB86AD9-4D26-4C33-A8B2-82BE161682E2/Windows Management Framework 5.0 Experimental Release July 2014 Release Notes.docx"><span style="color:#0000ff">Release Notes</span></a>
                    </li>
                    <li>
                        <a href="http://download.microsoft.com/download/E/D/B/EDB86AD9-4D26-4C33-A8B2-82BE161682E2/WindowsBlue-KB2969050-x64.msu"><span style="color:#0000ff">x64 MSU</span></a>
                    </li>
                    <li>
                        <a href="http://download.microsoft.com/download/E/D/B/EDB86AD9-4D26-4C33-A8B2-82BE161682E2/WindowsBlue-KB2969050-x86.msu"><span style="color:#0000ff">x86 MSU</span></a>
                    </li>
                </ul>
                <p>&nbsp;</p>
                <h1 style="color:#2e74b5; font-family:Calibri Light; font-size:large">Description</h1>
                <p>
                    The <strong>xWordPress </strong>module contains the <strong>xIisWordPressSite</strong> DSC Resource. This DSC Composite Configuration allows you to configure an IIS site with the file required to run WordPress and set the contents of the WordPress configuration
                    file.
                </p>
                <p>The <strong>xWordPress </strong>module also contains the <strong>xWordPressSite</strong> DSC Resource. This DSC Resource allows you to configure a&nbsp;WordPress Site.</p>
                <h1 style="color:#2e74b5; font-family:Calibri Light; font-size:large">Details</h1>
                <p><strong>xIisWordPressSite</strong> resource has following properties:</p>
                <ul style="list-style-type:disc; direction:ltr">
                    <li>
                        <strong>DestinationPath</strong>: <span style="left:250px">The path on the filesystem were the web site will be setup.</span>
                    </li>
                    <li>
                        <strong>DownloadUri</strong>: <span style="left:250px">The uri to download the WordPress Zip file</span>
                    </li>
                    <li>
                        <strong>PackageFolder</strong>: <span style="left:250px">The uri to download the WordPress Zip file computer name</span>
                    </li>
                    <li>
                        <strong>PackageFolder</strong>:&nbsp;<span style="left:250px">
                            The folder where the WordPress zip will be dowloaded. &nbsp;This path
                            <span style="font-weight:bold">MUST</span> already exist.
                        </span>
                    </li>
                    <li>
                        <strong>Configuration</strong>: <span style="left:250px">The&nbsp;contents of the WordPress configuration file (wp-config.php).</span>
                    </li>
                </ul>
                <p><strong>xWordPressSite</strong> resource has following properties:</p>
                <ul style="list-style-type:disc; direction:ltr">
                    <li>
                        <strong>Uri</strong>: <span style="left:250px">The WordPress Site URI..</span>
                    </li>
                    <li>
                        <strong>Title</strong>:&nbsp;<span style="left:250px">The WordPress Site Default page title.</span>
                    </li>
                    <li>
                        <strong>AdministratorCredential</strong>:&nbsp;<span style="left:250px">The username and password of the WordPress administrator to create when creating the site.</span>
                    </li>
                    <li>
                        <strong>AdministratorEmail</strong>:&nbsp;<span style="left:250px">The email address of the WordPress administrator to create.</span>
                    </li>
                    <li>
                        <strong>Ensure</strong>:&nbsp;<span style="left:250px">Currenly only Present is allowed.</span>
                    </li>
                </ul>
                <h1 style="color:#2e74b5; font-family:Calibri Light; font-size:large">Renaming Requirements</h1>
                <p>When making changes to these resources, we suggest the following practice:</p>
                <ol style="list-style-type:decimal; direction:ltr">
                    <li>
                        Update the following names by replacing MSFT with your company/community name and replacing the
                        <strong>&quot;x&quot;</strong> with <strong>&quot;c&quot;</strong> (short for &quot;Community&quot;) or another prefix of your choice:
                        <ul>
                            <li>
                                <strong>Module name (ex: xWordPress</strong> becomes <strong>cWordPress</strong>)
                            </li>
                            <li>
                                <strong>Resource folder (ex: MSFT_xWordPressSite</strong> becomes <strong>Contoso_cWordPressSite</strong>)
                            </li>
                            <li>
                                <strong>Resource Name (ex: MSFT_xWordPressSite</strong> becomes <strong>Contoso_cWordPressSite</strong>)
                            </li>
                            <li>
                                <strong>Resource Friendly Name (ex: xWordPressSite</strong> becomes <strong>cWordPressSite</strong>)
                            </li>
                            <li>
                                <strong>MOF class name (ex: MSFT_xWordPressSite</strong> becomes <strong>Contoso_cWordPressSite</strong>)
                            </li>
                            <li>
                                <strong>Filename for the &lt;resource&gt;.schema.mof (ex: MSFT_xWordPressSite</strong>.schema.mof becomes
                                <strong>Contoso_cWordPressSite</strong>.schema.mof)
                            </li>
                        </ul>
                    </li>
                    <li>Update module and metadata information in the module manifest </li>
                    <li>Update any configuration that use these resources </li>
                </ol>
                <p>
                    <em>
                        We reserve resource and module names without prefixes (&quot;x&quot; or &quot;c&quot;) for future use (e.g. &quot;MSFT_WordPressSite&quot; or &quot;WordPressSite&quot;). If the next version of Windows Server ships with a &quot;WordPressSite&quot; resource, we don't want to break any configurations that
                        use any community modifications. Please keep a prefix such as &quot;c&quot; on all community modifications.
                    </em>
                </p>
                <h1 style="color:#2e74b5; font-family:Calibri Light; font-size:large">Versions</h1>
                <p>1.0.0.0</p>
                <ul style="list-style-type:disc; direction:ltr">
                    <li>
                        Initial release with the following resources
                        <ul style="list-style-type:circle">
                            <li>xWordPressSite </li>
                            <li>xIisWordPressSite </li>
                        </ul>
                    </li>
                </ul>
                <h1 style="margin-bottom:0pt; font-family:Calibri Light; color:#2e74b5; font-size:large">
                    Example: Setup a WordPress Site on a single node
                </h1>
                This configuration will set a WordPress Site on a sigle node.<br>
                Note: this requires the following other modules: xWebAdministration, xPsDesiredStateConfiguration, xMySql, and xPhp (see
                <a href="#Example:_Install_xWordPress_Module_and">Example: Install xWordPress Module and the other required modules</a>).<br>
                <div class="scriptcode">
                    <div class="pluginEditHolder" plugincommand="mceScriptCode">
                        <div class="title"><span>PowerShell</span></div>
                        <div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
                        <span class="hidden">powershell</span>
<pre class="hidden"># This configuration configures a Basic WordPress Site
# It requires xPhp, xMySql, xWordPress, and xWebAdministration
# Please review the note about the FQDN variable and
# about the URLs, they may need to be updated.
# ********* NOTE ***********
# If you are not targetting the local machine, 
# or this does not resolve to the correct FQDN for the machine
# Update this to the FQDN of the target machine
# **************************
[string] $fqdn = [System.Net.Dns]::GetHostByName(($env:computerName)).HostName
Write-Host &quot;Target Machine FQDN: $fqdn&quot;
[string] $role = &quot;WordPress&quot;
$dataRoot = Split-Path $MyInvocation.MyCommand.Path
$phpTemplatePath = join-Path $dataRoot &quot;phpConfigTemplate.txt&quot;
$WordPressTemplatePath = Join-Path $dataRoot &quot;WordPressConfigurationTemplate.ps1&quot;
if (-not (Test-Path $WordPressTemplatePath))
{
    $message = &quot;Missing required file $WordPressTemplatePath&quot;
    # This file is in the samples folder of the resource
    throw $message
}
$plainPassword = &quot;pass@word1&quot;
$pwd = convertTo-SecureString -String $plainPassword -AsPlainText -Force
$WordPressUserName = &quot;WordPressUser&quot;
$WordPressDatabase = &quot;WordPress&quot;
# Generate the contents of the WordPress configuration
$wordPressConfig = &amp; $WordPressTemplatePath -WordPressDatabase $WordPressDatabase -WordPressUserName $WordPressUserName -PlainPassword $plainPassword
# ********* NOTE ***********
# PHP and My SQL change their download URLs frequently.  Please verify the URLs.
# the WordPress and VC Redist URL change less frequently, but should still be verified.
# After verifying the download URLs for the products and update them appropriately.
# **************************
$configurationData = @{  
    AllNodes = @(        
        @{
            Role = $role
            NodeName = $fqdn
            PSDscAllowPlainTextPassword = $true;
            WordPress = @{
                Title = &quot;DSC WordPress Site Title&quot;
                Admin = New-Object -TypeName System.Management.Automation.PSCredential -argumentlist (&ldquo;DscAdmin&rdquo;,$pwd)
                Email = &quot;dscadmin@contoso.com&quot;
                Uri = &quot;http://$fqdn&quot;
                DownloadURI = &quot;http://WordPress.org/latest.zip&quot;
                Path = (Join-Path $env:SystemDrive  &quot;wwwWordPress&quot;)
                Config = $wordPressConfig
                SiteName = &quot;WordPress&quot;
                TemplatePath = $WordPressTemplatePath  
                UserName = $WordPressUserName
                Database = $WordPressDatabase
                User = New-Object -TypeName System.Management.Automation.PSCredential -argumentlist (&ldquo;$WordPressUserName&rdquo;,$pwd)  
            }    
            
            Php = @{
                # Update with the latest &quot;VC11 x64 Non Thread Safe&quot; from http://windows.php.net/download/
                DownloadURI = &quot;http://windows.php.net/downloads/releases/php-5.5.14-nts-Win32-VC11-x64.zip&quot;
                TemplatePath = $phpTemplatePath 
                Path = &quot;$env:SystemDrive\php&quot;
                Vc2012RedistUri = &quot;http://download.microsoft.com/download/1/6/B/16B06F60-3B20-4FF2-B699-5E9B7962F9AE/VSU_4/vcredist_x64.exe&quot;
            }
            PackageFolder = &quot;$env:SystemDrive\packages&quot;
            MySqlDownloadURI = &quot;http://dev.mysql.com/get/Downloads/MySQLInstaller/mysql-installer-community-5.6.17.0.msi&quot;
            Credential = New-Object -TypeName System.Management.Automation.PSCredential -argumentlist (&ldquo;userNameNotUsed&rdquo;,$pwd) #the password for root. no user name is needed as MySql installer is using only the user &quot;root&quot;.
            PlainPassword = $plainPassword
            
         }
    )  
}
# Configuration to configure a Single machine WordPress Site
Configuration WordPress
{
    # Import composite resources
    Import-DscResource -module xMySql 
    Import-DscResource -module xPhp
    Import-DscResource -module xWordPress
    Node $AllNodes.NodeName
    {
        # Make sure we have a folder for the packages
        File PackagesFolder
        {
            DestinationPath = $Node.PackageFolder
            Type = &quot;Directory&quot;
            Ensure = &quot;Present&quot;
        }
        # Make sure PHP is installed in IIS
        xPhp  php
        {
            InstallMySqlExt = $true
            PackageFolder =  $Node.PackageFolder
            DownloadUri = $Node.Php.DownloadURI
            DestinationPath = $Node.Php.Path
            ConfigurationPath = $Node.Php.TemplatePath
            Vc2012RedistDownloadUri = $Node.Php.Vc2012RedistUri
        }
        # Make sure MySql is installed with a WordPress database
        xMySqlProvision mySql
        {
            ServiceName = &quot;MySqlService&quot;
            DownloadURI = $Node.MySqlDownloadURI
            RootCredential = $Node.Credential
            DatabaseName = &quot;WordPress&quot;
            UserCredential =  $Node.WordPress.User
        }
    
        # Make sure the IIS site for WordPress is created
        # Note, you still need to create the actuall WordPress Site after this.
        xIisWordPressSite iisWordPressSite
        {
            DestinationPath = $Node.WordPress.Path
            DownloadUri = $Node.WordPress.DownloadURI
            PackageFolder = $Node.PackageFolder 
            Configuration = $Node.WordPress.Config
        }
        # Make sure the WordPress site is present
        xWordPressSite WordPressSite
        {
            Uri = $Node.WordPress.Uri
            Title = $Node.WordPress.Title
            AdministratorCredential = $Node.WordPress.Admin
            AdministratorEmail = $Node.WordPress.Email
        } 
        # Make sure LCM will reboot if needed
        LocalConfigurationManager
        {
            RebootNodeIfNeeded = $true
            # uncomment when debugging on WMF 5 and above.
            # DebugMode = $true
        }
    }
}
$outputFolder = &quot;$env:USERPROFILE\Desktop\WordPress&quot;
Wordpress -OutputPath $outputFolder -ConfigurationData $configurationData
Set-DscLocalConfigurationManager -path $outputFolder -verbose
Start-DscConfiguration -Wait -Verbose -path $outputFolder
</pre>
                        <div class="preview">
<pre class="powershell"><span class="powerShell__com">#&nbsp;This&nbsp;configuration&nbsp;configures&nbsp;a&nbsp;Basic&nbsp;WordPress&nbsp;Site</span>&nbsp;
<span class="powerShell__com">#&nbsp;It&nbsp;requires&nbsp;xPhp,&nbsp;xMySql,&nbsp;xWordPress,&nbsp;and&nbsp;xWebAdministration</span>&nbsp;
<span class="powerShell__com">#&nbsp;Please&nbsp;review&nbsp;the&nbsp;note&nbsp;about&nbsp;the&nbsp;FQDN&nbsp;variable&nbsp;and</span>&nbsp;
<span class="powerShell__com">#&nbsp;about&nbsp;the&nbsp;URLs,&nbsp;they&nbsp;may&nbsp;need&nbsp;to&nbsp;be&nbsp;updated.</span>&nbsp;
&nbsp;
<span class="powerShell__com">#&nbsp;*********&nbsp;NOTE&nbsp;***********</span>&nbsp;
<span class="powerShell__com">#&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;targetting&nbsp;the&nbsp;local&nbsp;machine,&nbsp;</span>&nbsp;
<span class="powerShell__com">#&nbsp;or&nbsp;this&nbsp;does&nbsp;not&nbsp;resolve&nbsp;to&nbsp;the&nbsp;correct&nbsp;FQDN&nbsp;for&nbsp;the&nbsp;machine</span>&nbsp;
<span class="powerShell__com">#&nbsp;Update&nbsp;this&nbsp;to&nbsp;the&nbsp;FQDN&nbsp;of&nbsp;the&nbsp;target&nbsp;machine</span>&nbsp;
<span class="powerShell__com">#&nbsp;**************************</span>&nbsp;
[string]&nbsp;<span class="powerShell__variable">$fqdn</span>&nbsp;=&nbsp;[System.Net.Dns]::GetHostByName((<span class="powerShell__variable">$env</span>:computerName)).HostName&nbsp;
Write<span class="powerShell__operator">-</span>Host&nbsp;<span class="powerShell__string">&quot;Target&nbsp;Machine&nbsp;FQDN:&nbsp;$fqdn&quot;</span>&nbsp;
&nbsp;
[string]&nbsp;<span class="powerShell__variable">$role</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;WordPress&quot;</span>&nbsp;
<span class="powerShell__variable">$dataRoot</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">Split-Path</span>&nbsp;<span class="powerShell__variable">$MyInvocation</span>.MyCommand.Path&nbsp;
<span class="powerShell__variable">$phpTemplatePath</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">join-Path</span>&nbsp;<span class="powerShell__variable">$dataRoot</span>&nbsp;<span class="powerShell__string">&quot;phpConfigTemplate.txt&quot;</span>&nbsp;
<span class="powerShell__variable">$WordPressTemplatePath</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">Join-Path</span>&nbsp;<span class="powerShell__variable">$dataRoot</span>&nbsp;<span class="powerShell__string">&quot;WordPressConfigurationTemplate.ps1&quot;</span>&nbsp;
<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__operator">-</span>not&nbsp;(<span class="powerShell__cmdlets">Test-Path</span>&nbsp;<span class="powerShell__variable">$WordPressTemplatePath</span>))&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$message</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;Missing&nbsp;required&nbsp;file&nbsp;$WordPressTemplatePath&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;This&nbsp;file&nbsp;is&nbsp;in&nbsp;the&nbsp;samples&nbsp;folder&nbsp;of&nbsp;the&nbsp;resource</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">throw</span>&nbsp;<span class="powerShell__variable">$message</span>&nbsp;
}&nbsp;
<span class="powerShell__variable">$plainPassword</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;pass@word1&quot;</span>&nbsp;
<span class="powerShell__variable">$pwd</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">convertTo-SecureString</span>&nbsp;<span class="powerShell__operator">-</span>String&nbsp;<span class="powerShell__variable">$plainPassword</span>&nbsp;<span class="powerShell__operator">-</span>AsPlainText&nbsp;<span class="powerShell__operator">-</span>Force&nbsp;
<span class="powerShell__variable">$WordPressUserName</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;WordPressUser&quot;</span>&nbsp;
<span class="powerShell__variable">$WordPressDatabase</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;WordPress&quot;</span>&nbsp;
&nbsp;
<span class="powerShell__com">#&nbsp;Generate&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;WordPress&nbsp;configuration</span>&nbsp;
<span class="powerShell__variable">$wordPressConfig</span>&nbsp;=&nbsp;<span class="powerShell__operator">&amp;</span>&nbsp;<span class="powerShell__variable">$WordPressTemplatePath</span>&nbsp;<span class="powerShell__operator">-</span>WordPressDatabase&nbsp;<span class="powerShell__variable">$WordPressDatabase</span>&nbsp;<span class="powerShell__operator">-</span>WordPressUserName&nbsp;<span class="powerShell__variable">$WordPressUserName</span>&nbsp;<span class="powerShell__operator">-</span>PlainPassword&nbsp;<span class="powerShell__variable">$plainPassword</span>&nbsp;
&nbsp;
<span class="powerShell__com">#&nbsp;*********&nbsp;NOTE&nbsp;***********</span>&nbsp;
<span class="powerShell__com">#&nbsp;PHP&nbsp;and&nbsp;My&nbsp;SQL&nbsp;change&nbsp;their&nbsp;download&nbsp;URLs&nbsp;frequently.&nbsp;&nbsp;Please&nbsp;verify&nbsp;the&nbsp;URLs.</span>&nbsp;
<span class="powerShell__com">#&nbsp;the&nbsp;WordPress&nbsp;and&nbsp;VC&nbsp;Redist&nbsp;URL&nbsp;change&nbsp;less&nbsp;frequently,&nbsp;but&nbsp;should&nbsp;still&nbsp;be&nbsp;verified.</span>&nbsp;
<span class="powerShell__com">#&nbsp;After&nbsp;verifying&nbsp;the&nbsp;download&nbsp;URLs&nbsp;for&nbsp;the&nbsp;products&nbsp;and&nbsp;update&nbsp;them&nbsp;appropriately.</span>&nbsp;
<span class="powerShell__com">#&nbsp;**************************</span>&nbsp;
<span class="powerShell__variable">$configurationData</span>&nbsp;=&nbsp;@{&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;AllNodes&nbsp;=&nbsp;@(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Role&nbsp;=&nbsp;<span class="powerShell__variable">$role</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NodeName&nbsp;=&nbsp;<span class="powerShell__variable">$fqdn</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSDscAllowPlainTextPassword&nbsp;=&nbsp;<span class="powerShell__variable">$true</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WordPress&nbsp;=&nbsp;@{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Title&nbsp;=&nbsp;<span class="powerShell__string">&quot;DSC&nbsp;WordPress&nbsp;Site&nbsp;Title&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Admin&nbsp;=&nbsp;<span class="powerShell__cmdlets">New-Object</span>&nbsp;<span class="powerShell__operator">-</span>TypeName&nbsp;System.Management.Automation.PSCredential&nbsp;<span class="powerShell__operator">-</span>argumentlist&nbsp;(&ldquo;DscAdmin&rdquo;,<span class="powerShell__variable">$pwd</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email&nbsp;=&nbsp;<span class="powerShell__string">&quot;dscadmin@contoso.com&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uri&nbsp;=&nbsp;<span class="powerShell__string">&quot;http://$fqdn&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DownloadURI&nbsp;=&nbsp;<span class="powerShell__string">&quot;http://WordPress.org/latest.zip&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Path&nbsp;=&nbsp;(<span class="powerShell__cmdlets">Join-Path</span>&nbsp;<span class="powerShell__variable">$env</span>:SystemDrive&nbsp;&nbsp;<span class="powerShell__string">&quot;wwwWordPress&quot;</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Config&nbsp;=&nbsp;<span class="powerShell__variable">$wordPressConfig</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SiteName&nbsp;=&nbsp;<span class="powerShell__string">&quot;WordPress&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TemplatePath&nbsp;=&nbsp;<span class="powerShell__variable">$WordPressTemplatePath</span>&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserName&nbsp;=&nbsp;<span class="powerShell__variable">$WordPressUserName</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Database&nbsp;=&nbsp;<span class="powerShell__variable">$WordPressDatabase</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User&nbsp;=&nbsp;<span class="powerShell__cmdlets">New-Object</span>&nbsp;<span class="powerShell__operator">-</span>TypeName&nbsp;System.Management.Automation.PSCredential&nbsp;<span class="powerShell__operator">-</span>argumentlist&nbsp;(&ldquo;<span class="powerShell__variable">$WordPressUserName</span>&rdquo;,<span class="powerShell__variable">$pwd</span>)&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Php&nbsp;=&nbsp;@{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Update&nbsp;with&nbsp;the&nbsp;latest&nbsp;&quot;VC11&nbsp;x64&nbsp;Non&nbsp;Thread&nbsp;Safe&quot;&nbsp;from&nbsp;http://windows.php.net/download/</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DownloadURI&nbsp;=&nbsp;<span class="powerShell__string">&quot;http://windows.php.net/downloads/releases/php-5.5.14-nts-Win32-VC11-x64.zip&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TemplatePath&nbsp;=&nbsp;<span class="powerShell__variable">$phpTemplatePath</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Path&nbsp;=&nbsp;<span class="powerShell__string">&quot;$env:SystemDrive\php&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vc2012RedistUri&nbsp;=&nbsp;<span class="powerShell__string">&quot;http://download.microsoft.com/download/1/6/B/16B06F60-3B20-4FF2-B699-5E9B7962F9AE/VSU_4/vcredist_x64.exe&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PackageFolder&nbsp;=&nbsp;<span class="powerShell__string">&quot;$env:SystemDrive\packages&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MySqlDownloadURI&nbsp;=&nbsp;<span class="powerShell__string">&quot;http://dev.mysql.com/get/Downloads/MySQLInstaller/mysql-installer-community-5.6.17.0.msi&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Credential&nbsp;=&nbsp;<span class="powerShell__cmdlets">New-Object</span>&nbsp;<span class="powerShell__operator">-</span>TypeName&nbsp;System.Management.Automation.PSCredential&nbsp;<span class="powerShell__operator">-</span>argumentlist&nbsp;(&ldquo;userNameNotUsed&rdquo;,<span class="powerShell__variable">$pwd</span>)&nbsp;<span class="powerShell__com">#the&nbsp;password&nbsp;for&nbsp;root.&nbsp;no&nbsp;user&nbsp;name&nbsp;is&nbsp;needed&nbsp;as&nbsp;MySql&nbsp;installer&nbsp;is&nbsp;using&nbsp;only&nbsp;the&nbsp;user&nbsp;&quot;root&quot;.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PlainPassword&nbsp;=&nbsp;<span class="powerShell__variable">$plainPassword</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;
}&nbsp;
&nbsp;
<span class="powerShell__com">#&nbsp;Configuration&nbsp;to&nbsp;configure&nbsp;a&nbsp;Single&nbsp;machine&nbsp;WordPress&nbsp;Site</span>&nbsp;
Configuration&nbsp;WordPress&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Import&nbsp;composite&nbsp;resources</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Import<span class="powerShell__operator">-</span>DscResource&nbsp;<span class="powerShell__operator">-</span>module&nbsp;xMySql&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Import<span class="powerShell__operator">-</span>DscResource&nbsp;<span class="powerShell__operator">-</span>module&nbsp;xPhp&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Import<span class="powerShell__operator">-</span>DscResource&nbsp;<span class="powerShell__operator">-</span>module&nbsp;xWordPress&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Node&nbsp;<span class="powerShell__variable">$AllNodes</span>.NodeName&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Make&nbsp;sure&nbsp;we&nbsp;have&nbsp;a&nbsp;folder&nbsp;for&nbsp;the&nbsp;packages</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;PackagesFolder&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DestinationPath&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.PackageFolder&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__alias">Type</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;Directory&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensure&nbsp;=&nbsp;<span class="powerShell__string">&quot;Present&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Make&nbsp;sure&nbsp;PHP&nbsp;is&nbsp;installed&nbsp;in&nbsp;IIS</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xPhp&nbsp;&nbsp;php&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InstallMySqlExt&nbsp;=&nbsp;<span class="powerShell__variable">$true</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PackageFolder&nbsp;=&nbsp;&nbsp;<span class="powerShell__variable">$Node</span>.PackageFolder&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DownloadUri&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.Php.DownloadURI&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DestinationPath&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.Php.Path&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConfigurationPath&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.Php.TemplatePath&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vc2012RedistDownloadUri&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.Php.Vc2012RedistUri&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Make&nbsp;sure&nbsp;MySql&nbsp;is&nbsp;installed&nbsp;with&nbsp;a&nbsp;WordPress&nbsp;database</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xMySqlProvision&nbsp;mySql&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServiceName&nbsp;=&nbsp;<span class="powerShell__string">&quot;MySqlService&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DownloadURI&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.MySqlDownloadURI&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RootCredential&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.Credential&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DatabaseName&nbsp;=&nbsp;<span class="powerShell__string">&quot;WordPress&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserCredential&nbsp;=&nbsp;&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.User&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Make&nbsp;sure&nbsp;the&nbsp;IIS&nbsp;site&nbsp;for&nbsp;WordPress&nbsp;is&nbsp;created</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Note,&nbsp;you&nbsp;still&nbsp;need&nbsp;to&nbsp;create&nbsp;the&nbsp;actuall&nbsp;WordPress&nbsp;Site&nbsp;after&nbsp;this.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xIisWordPressSite&nbsp;iisWordPressSite&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DestinationPath&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.Path&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DownloadUri&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.DownloadURI&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PackageFolder&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.PackageFolder&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Configuration&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.Config&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Make&nbsp;sure&nbsp;the&nbsp;WordPress&nbsp;site&nbsp;is&nbsp;present</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xWordPressSite&nbsp;WordPressSite&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uri&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.Uri&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Title&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.Title&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AdministratorCredential&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.Admin&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AdministratorEmail&nbsp;=&nbsp;<span class="powerShell__variable">$Node</span>.WordPress.Email&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;Make&nbsp;sure&nbsp;LCM&nbsp;will&nbsp;reboot&nbsp;if&nbsp;needed</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalConfigurationManager&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RebootNodeIfNeeded&nbsp;=&nbsp;<span class="powerShell__variable">$true</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;uncomment&nbsp;when&nbsp;debugging&nbsp;on&nbsp;WMF&nbsp;5&nbsp;and&nbsp;above.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#&nbsp;DebugMode&nbsp;=&nbsp;$true</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}&nbsp;
&nbsp;
&nbsp;
<span class="powerShell__variable">$outputFolder</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;$env:USERPROFILE\Desktop\WordPress&quot;</span>&nbsp;
Wordpress&nbsp;<span class="powerShell__operator">-</span>OutputPath&nbsp;<span class="powerShell__variable">$outputFolder</span>&nbsp;<span class="powerShell__operator">-</span>ConfigurationData&nbsp;<span class="powerShell__variable">$configurationData</span>&nbsp;
&nbsp;
Set<span class="powerShell__operator">-</span>DscLocalConfigurationManager&nbsp;<span class="powerShell__operator">-</span>path&nbsp;<span class="powerShell__variable">$outputFolder</span>&nbsp;<span class="powerShell__operator">-</span>verbose&nbsp;
&nbsp;
Start<span class="powerShell__operator">-</span>DscConfiguration&nbsp;<span class="powerShell__operator">-</span>Wait&nbsp;<span class="powerShell__operator">-</span>Verbose&nbsp;<span class="powerShell__operator">-</span>path&nbsp;<span class="powerShell__variable">$outputFolder</span>&nbsp;
</pre>
                        </div>
                    </div>
                </div>
                <div class="endscriptcode">&nbsp;</div>
                <br>
                <h1 style="margin-bottom:0pt; font-family:Calibri Light; color:#2e74b5; font-size:large">
                    <a name="Example:_Install_xWordPress_Module_and"></a>Example: Install xWordPress Module and the other required modules
                </h1>
                Note: This require a version of WMF 5 see the <a href="https://msconfiggallery.cloudapp.net/">
                    Powershell Resource Gallery
                </a>for more details
                <p class="MsoNormal" style="background:white none repeat scroll 0% 50%; margin-bottom:0.0001pt; line-height:normal">
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:darkgreen"># This Script installs the required modules for the WordPress Sample</span><br>
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:darkgreen"># It uses the PowerShell Resource Gallery, see https://msconfiggallery.cloudapp.net/</span><br>
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:darkgreen">
                        # This requires WMF 5.<span>
                            &nbsp;
                        </span>If you don't have WMF 5, Please install the modules manually.
                    </span>
                </p>
                <p class="MsoNormal" style="background:white none repeat scroll 0% 50%; margin-bottom:0.0001pt; line-height:normal">
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:blue">Write-Host</span><span style="font-size:9pt; font-family:&quot;Lucida Console&quot;">
                        <span style="color:darkred">&quot;Installing required modules...&quot;</span>
                    </span>
                </p>
                <p class="MsoNormal" style="background:white none repeat scroll 0% 50%; margin-bottom:0.0001pt; line-height:normal">
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:darkgreen">&nbsp;</span><span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:blue">Install-Module</span><span style="font-size:9pt; font-family:&quot;Lucida Console&quot;">
                        <span style="color:blueviolet">xWebAdministration</span> <span style="color:navy">
                            -MinimumVersion
                        </span><span style="color:blueviolet">1.3.2</span> <span style="color:navy">
                            -Force
                        </span>
                    </span><br>
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:blue">Install-Module</span><span style="font-size:9pt; font-family:&quot;Lucida Console&quot;">
                        <span style="color:blueviolet">xPSDesiredStateConfiguration</span> <span style="color:navy">
                            -MinimumVersion
                        </span><span style="color:blueviolet">3.0.1</span> <span style="color:navy">
                            -Force
                        </span>
                    </span><br>
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:blue">Install-Module</span><span style="font-size:9pt; font-family:&quot;Lucida Console&quot;">
                        <span style="color:blueviolet">xMySql</span> <span style="color:navy">-MinimumVersion</span>
                        <span style="color:purple">1.0</span> <span style="color:navy">-Force</span>
                    </span>
                    <br>
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:blue">Install-Module</span><span style="font-size:9pt; font-family:&quot;Lucida Console&quot;">
                        <span style="color:blueviolet">xWordPress</span> <span style="color:navy">-MinimumVersion</span>
                        <span style="color:purple">1.0</span> <span style="color:navy">-Force</span>
                    </span>
                    <br>
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;; color:blue">Install-Module</span><span style="font-size:9pt; font-family:&quot;Lucida Console&quot;">
                        <span style="color:blueviolet">xPhp</span> <span style="color:navy">-MinimumVersion</span>
                        <span style="color:blueviolet">1.0.1</span> <span style="color:navy">-Force</span>
                    </span>
                </p>
                <p class="MsoNormal" style="background:white none repeat scroll 0% 50%; margin-bottom:0.0001pt; line-height:normal">
                    <span style="font-size:9pt; font-family:&quot;Lucida Console&quot;"><span>&nbsp;</span></span>
                </p>
            </div>

</body>
</html>